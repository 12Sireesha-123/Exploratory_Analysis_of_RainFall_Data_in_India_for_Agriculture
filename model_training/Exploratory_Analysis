import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

     

data = pd.read_csv("/content/WeatherAUS.csv")

     

data.head()
data.describe()
data.info()
data.shape

     
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 145460 entries, 0 to 145459
Data columns (total 23 columns):
 #   Column         Non-Null Count   Dtype  
---  ------         --------------   -----  
 0   Date           145460 non-null  object 
 1   Location       145460 non-null  object 
 2   MinTemp        143975 non-null  float64
 3   MaxTemp        144199 non-null  float64
 4   Rainfall       142199 non-null  float64
 5   Evaporation    82670 non-null   float64
 6   Sunshine       75625 non-null   float64
 7   WindGustDir    135134 non-null  object 
 8   WindGustSpeed  135197 non-null  float64
 9   WindDir9am     134894 non-null  object 
 10  WindDir3pm     141232 non-null  object 
 11  WindSpeed9am   143693 non-null  float64
 12  WindSpeed3pm   142398 non-null  float64
 13  Humidity9am    142806 non-null  float64
 14  Humidity3pm    140953 non-null  float64
 15  Pressure9am    130395 non-null  float64
 16  Pressure3pm    130432 non-null  float64
 17  Cloud9am       89572 non-null   float64
 18  Cloud3pm       86102 non-null   float64
 19  Temp9am        143693 non-null  float64
 20  Temp3pm        141851 non-null  float64
 21  RainToday      142199 non-null  object 
 22  RainTomorrow   142207 non-null  object 
dtypes: float64(16), object(7)
memory usage: 25.5+ MB
(145460, 23)

data.isnull().sum()

     
0
Date	0
Location	0
MinTemp	1485
MaxTemp	1261
Rainfall	3261
Evaporation	62790
Sunshine	69835
WindGustDir	10326
WindGustSpeed	10263
WindDir9am	10566
WindDir3pm	4228
WindSpeed9am	1767
WindSpeed3pm	3062
Humidity9am	2654
Humidity3pm	4507
Pressure9am	15065
Pressure3pm	15028
Cloud9am	55888
Cloud3pm	59358
Temp9am	1767
Temp3pm	3609
RainToday	3261
RainTomorrow	3253

dtype: int64

cat_cols = data.select_dtypes(include='object').columns
num_cols = data.select_dtypes(exclude='object').columns

     

from sklearn.impute import SimpleImputer

num_imputer = SimpleImputer(strategy='mean')
data[num_cols] = num_imputer.fit_transform(data[num_cols])

     

cat_imputer = SimpleImputer(strategy='most_frequent')
data[cat_cols] = cat_imputer.fit_transform(data[cat_cols])

     

from sklearn.preprocessing import LabelEncoder

encoders = {}

for col in cat_cols:
    le = LabelEncoder()
    data[col] = le.fit_transform(data[col])
    encoders[col] = le

     

import matplotlib.pyplot as plt
import seaborn as sns

plt.figure(figsize=(10,6))
sns.set_style("whitegrid")

     
<Figure size 1000x600 with 0 Axes>

cor = data.corr()
cor

     
Date	Location	MinTemp	MaxTemp	Rainfall	Evaporation	Sunshine	WindGustDir	WindGustSpeed	WindDir9am	...	Humidity9am	Humidity3pm	Pressure9am	Pressure3pm	Cloud9am	Cloud3pm	Temp9am	Temp3pm	RainToday	RainTomorrow
Date	1.000000	0.020198	0.020929	0.043892	-0.012112	0.060267	0.008184	-0.019588	-0.022976	0.002318	...	0.000045	-0.010951	0.031792	0.025755	0.051669	0.032652	0.031165	0.031318	-0.012801	-0.008470
Location	0.020198	1.000000	-0.008537	-0.022893	-0.003214	0.030609	0.002118	-0.003074	0.070514	-0.002808	...	0.000225	0.013321	0.035801	0.045928	-0.008536	-0.014150	-0.018206	-0.025735	-0.005573	0.001176
MinTemp	0.020929	-0.008537	1.000000	0.733400	0.102706	0.351321	0.051297	-0.136443	0.172553	-0.031327	...	-0.230970	0.005995	-0.423584	-0.433147	0.062151	0.016722	0.897692	0.699211	0.054559	0.083155
MaxTemp	0.043892	-0.022893	0.733400	1.000000	-0.074040	0.438653	0.328931	-0.211930	0.065895	-0.212968	...	-0.497927	-0.498760	-0.308309	-0.396622	-0.225315	-0.212760	0.879170	0.968713	-0.225439	-0.155381
Rainfall	-0.012112	-0.003214	0.102706	-0.074040	1.000000	-0.037863	-0.170973	0.044620	0.126446	0.084716	...	0.221380	0.248905	-0.159055	-0.119541	0.171144	0.145343	0.011069	-0.077684	0.499899	0.232781
Evaporation	0.060267	0.030609	0.351321	0.438653	-0.037863	1.000000	0.288169	-0.068923	0.147353	-0.064356	...	-0.373732	-0.286025	-0.210961	-0.230351	-0.150264	-0.145472	0.414592	0.425573	-0.139275	-0.088555
Sunshine	0.008184	0.002118	0.051297	0.328931	-0.170973	0.288169	1.000000	-0.063413	-0.023844	-0.070714	...	-0.348855	-0.443121	0.031406	-0.014815	-0.532497	-0.553853	0.208580	0.346685	-0.235296	-0.322506
WindGustDir	-0.019588	-0.003074	-0.136443	-0.211930	0.044620	-0.068923	-0.063413	1.000000	0.136200	0.353790	...	0.068775	0.065027	-0.119516	-0.031416	0.065525	0.057989	-0.177746	-0.223028	0.124675	0.048793
WindGustSpeed	-0.022976	0.070514	0.172553	0.065895	0.126446	0.147353	-0.023844	0.136200	1.000000	0.073234	...	-0.207964	-0.025355	-0.425760	-0.383938	0.052417	0.079927	0.145904	0.031884	0.145700	0.220406
WindDir9am	0.002318	-0.002808	-0.031327	-0.212968	0.084716	-0.064356	-0.070714	0.353790	0.073234	1.000000	...	0.088769	0.148476	-0.049202	0.040928	0.085977	0.053639	-0.116825	-0.220361	0.167718	0.036326
WindDir3pm	0.002245	0.009451	-0.159783	-0.182044	0.048193	-0.044765	-0.033576	0.563161	0.135583	0.301249	...	0.026167	-0.006052	-0.133330	-0.037334	0.047560	0.050306	-0.176633	-0.193989	0.121719	0.029703
WindSpeed9am	-0.012682	0.078029	0.173404	0.014294	0.085925	0.139968	0.003843	0.008386	0.577319	0.108959	...	-0.268271	-0.030887	-0.215339	-0.165388	0.019714	0.041667	0.127592	0.004476	0.098636	0.088438
WindSpeed3pm	-0.022834	0.064266	0.173058	0.049717	0.056527	0.094352	0.037836	0.084011	0.657243	0.111575	...	-0.143458	0.016275	-0.277604	-0.239659	0.041611	0.019813	0.161060	0.027587	0.077076	0.085670
Humidity9am	0.000045	0.000225	-0.230970	-0.497927	0.221380	-0.373732	-0.348855	0.068775	-0.207964	0.088769	...	1.000000	0.659072	0.131503	0.176009	0.353490	0.273314	-0.469641	-0.490709	0.347034	0.249656
Humidity3pm	-0.010951	0.013321	0.005995	-0.498760	0.248905	-0.286025	-0.443121	0.065027	-0.025355	0.148476	...	0.659072	1.000000	-0.025848	0.048695	0.398762	0.406605	-0.216964	-0.555608	0.367937	0.431282
Pressure9am	0.031792	0.035801	-0.423584	-0.308309	-0.159055	-0.210961	0.031406	-0.119516	-0.425760	-0.049202	...	0.131503	-0.025848	1.000000	0.959662	-0.101611	-0.114425	-0.397131	-0.265532	-0.177981	-0.228945
Pressure3pm	0.025755	0.045928	-0.433147	-0.396622	-0.119541	-0.230351	-0.014815	-0.031416	-0.383938	0.040928	...	0.176009	0.048695	0.959662	1.000000	-0.047718	-0.065929	-0.441459	-0.360707	-0.099509	-0.209638
Cloud9am	0.051669	-0.008536	0.062151	-0.225315	0.171144	-0.150264	-0.532497	0.065525	0.052417	0.085977	...	0.353490	0.398762	-0.101611	-0.047718	1.000000	0.559800	-0.108986	-0.231807	0.243208	0.247554
Cloud3pm	0.032652	-0.014150	0.016722	-0.212760	0.145343	-0.145472	-0.553853	0.057989	0.079927	0.053639	...	0.273314	0.406605	-0.114425	-0.065929	0.559800	1.000000	-0.098697	-0.246754	0.212269	0.296024
Temp9am	0.031165	-0.018206	0.897692	0.879170	0.011069	0.414592	0.208580	-0.177746	0.145904	-0.116825	...	-0.469641	-0.216964	-0.397131	-0.441459	-0.108986	-0.098697	1.000000	0.846141	-0.095952	-0.023957
Temp3pm	0.031318	-0.025735	0.699211	0.968713	-0.077684	0.425573	0.346685	-0.223028	0.031884	-0.220361	...	-0.490709	-0.555608	-0.265532	-0.360707	-0.231807	-0.246754	0.846141	1.000000	-0.229689	-0.186278
RainToday	-0.012801	-0.005573	0.054559	-0.225439	0.499899	-0.139275	-0.235296	0.124675	0.145700	0.167718	...	0.347034	0.367937	-0.177981	-0.099509	0.243208	0.212269	-0.095952	-0.229689	1.000000	0.304062
RainTomorrow	-0.008470	0.001176	0.083155	-0.155381	0.232781	-0.088555	-0.322506	0.048793	0.220406	0.036326	...	0.249656	0.431282	-0.228945	-0.209638	0.247554	0.296024	-0.023957	-0.186278	0.304062	1.000000
23 rows Ã— 23 columns


plt.figure(figsize=(12,8))
sns.heatmap(cor, annot=False, cmap='coolwarm')
plt.title("Correlation Heatmap")
plt.show()

     


sns.pairplot(data[['MinTemp','MaxTemp','Rainfall','Humidity9am','Humidity3pm','RainTomorrow']])
plt.show()

     


plt.figure(figsize=(15,6))
data.boxplot()
plt.xticks(rotation=90)
plt.title("Boxplot for Outlier Detection")
plt.show()

     


sns.jointplot(x='MinTemp', y='Rainfall', data=data, kind='scatter')
plt.show()

     


sns.jointplot(x='MaxTemp', y='Rainfall', data=data, hue='RainTomorrow')
plt.show()

     


sns.histplot(data['RainTomorrow'])
plt.title("Distribution of RainTomorrow")
plt.show()

     


plt.figure(figsize=(8,5))
sns.scatterplot(x='MaxTemp', y='Rainfall', data=data)
plt.show()

     


sns.histplot(data['MinTemp'], kde=True)
plt.title("Distribution of MinTemp")
plt.show()

     


y = data['RainTomorrow']
X = data.drop('RainTomorrow', axis=1)

     

from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
X = scaler.fit_transform(X)

     

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=0
)

     

from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from sklearn.svm import SVC
from xgboost import XGBClassifier

from sklearn.metrics import accuracy_score

     

log_model = LogisticRegression(max_iter=1000)
dt_model = DecisionTreeClassifier()
rf_model = RandomForestClassifier()
svm_model = SVC()
gb_model = GradientBoostingClassifier()
xgb_model = XGBClassifier(use_label_encoder=False, eval_metric='logloss')

     

log_model.fit(X_train, y_train)
dt_model.fit(X_train, y_train)
rf_model.fit(X_train, y_train)
svm_model.fit(X_train, y_train)
gb_model.fit(X_train, y_train)
xgb_model.fit(X_train, y_train)

     
/usr/local/lib/python3.12/dist-packages/xgboost/training.py:199: UserWarning: [09:57:46] WARNING: /workspace/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric='logloss',
              feature_types=None, feature_weights=None, gamma=None,
              grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, ...)
In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook.
On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.

log_pred = log_model.predict(X_test)
dt_pred = dt_model.predict(X_test)
rf_pred = rf_model.predict(X_test)
svm_pred = svm_model.predict(X_test)
gb_pred = gb_model.predict(X_test)
xgb_pred = xgb_model.predict(X_test)

     

print("Logistic Regression Accuracy:", accuracy_score(y_test, log_pred))
print("Decision Tree Accuracy:", accuracy_score(y_test, dt_pred))
print("Random Forest Accuracy:", accuracy_score(y_test, rf_pred))
print("SVM Accuracy:", accuracy_score(y_test, svm_pred))
print("Gradient Boosting Accuracy:", accuracy_score(y_test, gb_pred))
print("XGBoost Accuracy:", accuracy_score(y_test, xgb_pred))

     
Logistic Regression Accuracy: 0.8434277464595078
Decision Tree Accuracy: 0.7903547366973739
Random Forest Accuracy: 0.8570053622989138
SVM Accuracy: 0.8523992850268115
Gradient Boosting Accuracy: 0.8500274989687887
XGBoost Accuracy: 0.859720885466795

models = ['Logistic', 'Decision Tree', 'Random Forest', 'SVM', 'Gradient Boost', 'XGBoost']
scores = [
    accuracy_score(y_test, log_pred),
    accuracy_score(y_test, dt_pred),
    accuracy_score(y_test, rf_pred),
    accuracy_score(y_test, svm_pred),
    accuracy_score(y_test, gb_pred),
    accuracy_score(y_test, xgb_pred)
]

accuracy_df = pd.DataFrame({
    'Model': models,
    'Accuracy': scores
})

accuracy_df.sort_values(by='Accuracy', ascending=False)

     
Model	Accuracy
5	XGBoost	0.859721
2	Random Forest	0.857005
3	SVM	0.852399
4	Gradient Boost	0.850027
0	Logistic	0.843428
1	Decision Tree	0.790355

best_model = rf_model  # assuming Random Forest gives highest accuracy

     

import pickle

pickle.dump(best_model, open("rainfall.pkl","wb"))
pickle.dump(scaler, open("scaler.pkl","wb"))
pickle.dump(encoders, open("encoder.pkl","wb"))
pickle.dump(num_imputer, open("imputer.pkl","wb"))


     
